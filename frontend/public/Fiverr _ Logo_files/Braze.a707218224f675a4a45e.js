!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require("lodash"),require("react"),require("react-dom"));else if("function"==typeof define&&define.amd)define(["lodash","react","react-dom"],t);else{var r="object"==typeof exports?t(require("lodash"),require("react"),require("react-dom")):t(e._,e.React17,e.ReactDOM17);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(self,((e,t,r)=>(()=>{var n={"4LQx":e=>{"use strict";e.exports=r},AojJ:e=>{e.exports={}},LomL:(e,t,r)=>{"use strict";const{DEFAULT_LOCALE:n}=r("phzZ");t.A={locale:n,computedLocale:n,userId:0,country:"",countryCode:"",pageCtxId:"",isPro:!1,abTests:{},userAgent:"",knownCrawler:!1,csrfToken:"",browserLanguage:"",currency:"",pathParameters:{},queryParameters:{},userGuid:"",url:"",ip:"",referrer:"",organizationId:"",experience:{isBuyer:!1,isSeller:!1,isBusiness:!1,value:""},isMobile:!1,isTouch:!1,isIos:!1}},luq0:t=>{"use strict";t.exports=e},phzZ:(e,t)=>{"use strict";t.DEFAULT_LOCALE="en-US"},yHGu:e=>{"use strict";e.exports=t}},o={};function i(e){var t=o[e];if(void 0!==t)return t.exports;var r=o[e]={exports:{}};return n[e](r,r.exports,i),r.exports}i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},i.d=(e,t)=>{for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);return(()=>{"use strict";const e="object"==typeof window&&window.window===window&&window||"object"==typeof i.g&&i.g.global===i.g&&i.g||"object"==typeof self&&self.self===self&&self,t=Symbol(),r=Symbol();class n{constructor(){let{log:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this[t]=new Map,this[r]=e?[]:null}on(e,r){let n=this[t].get(e);n||(this[t].set(e,new Set),n=this[t].get(e)),n.add(r)}once(e,t){var r=this;const n=function(){r.off(e,n),t(...arguments)};this.on(e,n)}one(e,t){this.has(e)||this.on(e,t)}has(e){return this[t].has(e)}off(e,r){if(!this[t].has(e))return;if(void 0===r)return void this[t].delete(e);const n=this[t].get(e);n.delete(r),0===n.size&&this[t].delete(e)}emit(e){for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];const c=this[t].get(e);null!==this[r]&&this[r].push({event:e,args:o}),c&&c.forEach((e=>{e(...o)}))}deferred(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Promise.resolve().then((()=>{this.emit(e,...r)}))}get log(){return this[r]}clearLog(){null!==this[r]&&(this[r]=[])}}const o=Symbol.for("globalEventBus"),c=e[o]=e[o]||new n,s=["count","time","gauge","set","histogram"],a=s.reduce(((e,t)=>Object.assign(e,{[t]:function(e,r,n){let{rate:o,tags:i,enforceRate:s}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};Object.entries({prefix:e,metric:r}).forEach(((e,t)=>{let[r,n]=e;if("string"!=typeof n||!n)throw new TypeError("Expected argument ".concat(t," (").concat(r,") to be a string. Instead got ").concat(typeof n," (").concat(n,")"))}));const a=[e,r].join(".");return c.deferred("OBS::STATS",{type:t,key:a,value:n,rate:o,tags:i,enforceRate:s})}})),{});Object.defineProperty(a,"prefix",{value:e=>s.reduce(((t,r)=>Object.assign(t,{[r]:a[r].bind(a,e)})),{})});const u=a,d=(l="_logErrorToServer",function(){return(e=>"object"==typeof Fiverr&&"function"==typeof Fiverr[e]||void 0)(l)&&Fiverr[l](...arguments)});var l;const f=function(){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"").split(".").reduce(((e,t)=>"object"==typeof e?e[t]:e),t)},p=["get","value","set","configurable","enumerable","writable"],g=["get","value"];function y(e){const t={};function r(e,r){return t[e]=e in t?t[e]:r()}for(var n=arguments.length,o=new Array(n>1?n-1:0),i=1;i<n;i++)o[i-1]=arguments[i];o.forEach((t=>v.call(e,t,r)))}function v(e,t){const r=Object.getOwnPropertyDescriptor(this.constructor.prototype,e),n=p.reduce(((n,o)=>{switch(typeof r[o]){case"undefined":break;case"function":g.includes(o)?n[o]=()=>t("".concat(e,"$").concat(o),r[o].bind(this)):n[o]=r[o];break;default:n[o]=r[o]}return n}),{});Object.defineProperty(this,e,n)}const h=new class{constructor(){y(this,"node","browser","development","production","testing","plike","toString")}get node(){return"[object process]"===Object.prototype.toString.call(void 0!==e.process?e.process:0)}get browser(){return e.document&&"function"==typeof e.document.createElement||!this.node&&[typeof document,typeof window].every((e=>"undefined"!==e))}get development(){return this.toString().includes("dev")}get dev(){return this.development}get production(){return this.toString().includes("prod")}get prod(){return this.production}get testing(){return this.toString().includes("test")}get test(){return this.testing}get plike(){return this.toString().includes("like")}toString(){const e=this.node?f("process.env.NODE_ENV"):f("app.environment")||(e=>{if("undefined"==typeof document)return;const t=document.querySelector('meta[name="'.concat(e,'"]'));return t&&t.getAttribute("content")||void 0})("app_environment");return(e||"").toLowerCase()}},b=Symbol.for("SocketHandler"),m=Symbol.for("SocketSubscriptions"),w=Symbol.for("AsyncSubscriptionIdPromise"),O=Symbol.for("AsyncSubscriptionIdResolver"),S=Symbol.for("SocketReconnectRetryCount"),E=[2,3],j="close",x="message",_=2;e[m]=e[m]||new n,e[w]=e[w]||new Promise((t=>{e[O]=e[O]||t})),e[S]=e[S]||0;const L=function(){let{data:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(t){try{t=JSON.parse(t)}catch(e){d("socketHandler","incomingHandler","unable to parse event: ".concat(t))}t&&"object"==typeof t&&t.eventType&&e[m].emit(t.eventType,t)}},A=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0;"string"==typeof r&&r.split(" ").forEach((r=>e[m][t](r,n)))},P={connect:function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const{reconnectMaxRetries:o=_}=n;return!t||e[b]&&!E.includes(e[b].readyState)||!h.browser||(e[b]=new WebSocket(t),e[O](r.payload.subscription),e[b].addEventListener("open",(()=>{e[S]=0,e[b].addEventListener(x,L),P.send(r)})),e[b].addEventListener(j,(function i(){if(e[S]<o){e[S]++;const o=1500*Math.pow(2,e[S]-1);setTimeout((()=>{P.connect(t,r,n)}),o)}e[b].removeEventListener(j,i),e[b].removeEventListener(x,L)}))),P},send:function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return h.browser&&1===e[b].readyState&&e[b].send(JSON.stringify(t)),P},on:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return A("on",...t)},once:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return A("once",...t)},off:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return A("off",...t)},getSubscriptionId:()=>e[w]},R=e=>{window.braze&&e.custom_event_name&&(document.hidden?C.queue.push((()=>{k(e)})):k(e))},k=e=>{let{custom_event_name:t,properties:r}=e;window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:"braze_event",brazeEventName:t,brazeEventProperties:r})},C={init(){this.queue=[],this.subscribeSocketHandler(),this.bindWindowFocusEvent()},bindWindowFocusEvent(){window.addEventListener("focus",(()=>{for(;this.queue.length>0;){this.queue.pop()()}}))},subscribeSocketHandler(){P.on("braze_custom_event",R)}};i("AojJ");const D=()=>{window.addEventListener("brazeOnLogCustomEvent",(e=>{var t;const r=(null==e||null===(t=e.detail)||void 0===t?void 0:t.eventName)||null;r&&u.count("packages.braze_package","log_custom_event.".concat(r))})),C.init()};i("yHGu"),i("4LQx");const I="OBS::LOGGER",B="debug",T="verbose",q="info",z="warn",N="error",F="critical",H=[B,T,q,z,N,F],M=H.reduce(((e,t)=>Object.assign(e,{[t]:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.deferred(I,{entity:e,enrichments:r,level:t})}})),{});Object.defineProperty(M,"force",{value:H.reduce(((e,t)=>Object.assign(e,{[t]:function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return c.deferred(I,{entity:e,enrichments:r,level:t,force:true})}})),{})});const G=M;var U=i("luq0"),J=i.n(U);function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function W(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const K=e=>{return function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(r),!0).forEach((function(t){W(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({type:e.type,name:e.name,created_at:new Date(e.createdAt).toISOString(),duration:e.duration||null,value:e.value||null},{context_id:(t=e.context).id,user_id:t.userId.toString(),country_code:t.countryCode,browser:t.browserName,locale:t.locale,currency:t.currency,platform:t.platform});var t},V=(e=>function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return c.deferred(e,{events:r})})("OBS::BIG_QUERY_MONICORE"),Z="monicore",Y="mobile_web",$="web";class X extends Error{constructor(e){super(e),this.name="ContextNotFoundError"}}var ee=i("LomL");const te=()=>{const e=J().get(window,"initialData.FiverrContext");return e||(G.error({message:"Browser context does not exist, please ensure the run time owner sets one on the window scope before using this API"}),ee.A)},re=()=>{const{pageCtxId:e,userId:t,countryCode:r,locale:n,isMobile:o,currency:i}=te();return{id:e||"",userId:t||"",countryCode:r||"",locale:n||"",currency:i||"",platform:o?Y:$}},ne=Date.now(),oe=window.performance&&window.performance.now?window.performance:{now:()=>Date.now()-ne,timeOrigin:ne},ie="event",ce="error",se=[ie,ce],ae="ADD_EVENT_ERROR",ue="ADD_ERROR_ERROR",de=()=>oe.now()+(()=>{let e=oe.timeOrigin;return"number"!=typeof e&&(e=oe.timing&&oe.timing.navigationStart),e})(),le=e=>!(!(0,U.isUndefined)(e)&&!(0,U.isString)(e))||(G.error("Expected value to be a string. Instead got a ".concat(typeof e),{caughtBy:Z,value:e}),!1),fe=e=>!(!(0,U.isString)(e)||(0,U.isEmpty)(e))||(G.error("Expected name to be a string. Instead got a ".concat(typeof e),{caughtBy:Z,name:e}),!1),pe=()=>{u.count("monicore","context_not_found")},ge=e=>(e=>{e.context.isKnownCrawler||V(K(e))})(e),ye=(e,t)=>{try{return function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ie;if(fe(e))if(se.includes(r)){le(t)||(t=void 0);try{const n={name:e,value:t,type:r,createdAt:de(),context:re()};ge(n)}catch(e){e instanceof X?pe():G.warn(e,{caughtBy:Z,code:ae})}}else G.error('Expected "type" to be event or error. Instead got a '.concat(r),{caughtBy:Z,code:ae})}(e,t,ce)}catch(e){G.warn(e,{caughtBy:Z,code:ue})}},ve=(e,t,r)=>{const n="Layout component: ".concat(t,", failed on entry: ").concat(r,"."),o="layout.CSR.".concat(t,".").concat(r),i="layout.CSR_LOAD_CHUNK.".concat(t,".").concat(r),c=te();e instanceof Error&&"ChunkLoadError"===(null==e?void 0:e.name)?ye(i):(G.error(e,{context:c,description:n,componentName:t,entryName:r,package:"@fiverr-private/layout-sdk"}),ye(o))};try{D(window.initialData.Braze)}catch(e){ve(e,"Braze","Braze")}})(),{}})()));
//# sourceMappingURL=Braze.a707218224f675a4a45e.js.map